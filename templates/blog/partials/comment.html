<div class="d-flex {% if comment.level > 0 %}ms-4 ms-md-5{% endif %} mt-4" id="comment-{{ comment.pk }}">
    <div class="flex-shrink-0">
        <img class="rounded-circle" src="{{ comment.user.profile.image.url }}" alt="{{ comment.user.username }}" width="60" height="60">
    </div>
    <div class="ms-3 flex-grow-1">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <span class="fw-bold">{{ comment.user.profile.nickname|default:comment.user.username }}</span>
                {% if comment.parent %}
                    <span class="text-muted mx-1">回复</span>
                    <span class="fw-bold">{{ comment.parent.user.profile.nickname|default:comment.parent.user.username }}</span>
                {% endif %}
            </div>
            <small class="text-muted">{{ comment.created_on|date:"Y-m-d H:i" }}</small>
        </div>

        {% if comment.parent %}
        <div class="alert alert-light p-2 mt-2 mb-2">
            <p class="mb-0 small text-muted fst-italic">
                "{{ comment.parent.content|striptags|truncatewords:20 }}"
            </p>
        </div>
        {% endif %}
        
        <p class="mt-2">{{ comment.content|linebreaksbr }}</p>

        <div class="d-flex justify-content-between align-items-center">
            <div>
                <button class="btn btn-sm btn-link text-decoration-none reply-btn" data-comment-id="{{ comment.pk }}" data-username="{{ comment.user.profile.nickname|default:comment.user.username }}">回复</button>
            </div>
            {% if request.user == comment.user %}
            <div>
                <a href="{% url 'blog:delete_comment' comment.pk %}" class="btn btn-sm btn-link text-decoration-none text-danger">删除</a>
            </div>
            {% endif %}
        </div>
        
        <div class="reply-form-container mt-3" id="reply-form-container-{{ comment.pk }}" style="display: none;"></div>
    </div>
</div>